#!/usr/bin/env python
# -*- coding: utf-8 -*-

from apk_parse.apk import APK
import os
def find_vir():
	count = 1
	pwd = '/home/dac/MalwareAPP/train_data'
	for path, dir, files in os.walk(pwd):
		for file in files:
			if os.path.splitext(file)[1].lower()=='.vir':
				test('/home/dac/mal/'+file, file)
				print count
				count = count + 1

def extraction(apk_path, file):
    t = "<sep>"
    apkf = APK(apk_path)
    f = open ("train.csv", 'a')
    f.write(file+t)
    f.write(str(apkf.cert_text)+t)
    f.write(str(apkf.file_md5)+t)
    f.write(str(apkf.cert_md5)+t)
    f.write(str(apkf.file_size)+t)
    f.write(str(apkf.androidversion)+t)
    f.write(str(apkf.package)+t)
    f.write(str(apkf.get_android_manifest_xml())+t)
    f.write(str(apkf.get_android_manifest_axml())+t)
    f.write(str(apkf.is_valid_APK())+t)
    f.write(str(apkf.get_filename())+t)
    f.write(str(apkf.get_package())+t)
    f.write(str(apkf.get_androidversion_code())+t)
    f.write(str(apkf.get_androidversion_name())+t)
    f.write(str(apkf.get_max_sdk_version())+t)
    f.write(str(apkf.get_min_sdk_version())+t)
    f.write(str(apkf.get_target_sdk_version())+t)
    f.write(str(apkf.get_libraries())+t)
    f.write(str(apkf.get_files())+t)
    f.write(str(apkf.get_files_types())+t)
    f.write(str(apkf.get_main_activity())+t)
    f.write(str(apkf.get_activities())+t)
    f.write(str(apkf.get_services())+t)
    f.write(str(apkf.get_receivers())+t)
    f.write(str(apkf.get_providers())+t)
    f.write(str(apkf.get_permissions()))
    f.write("<new>")


if __name__ == "__main__":
	find_vir()
	#test()
